#!/bin/sh

# Script to connect to existing IRC channels using lchat-connect
# Usage: lchat-channel <channel-name>
# just a wrapper for lchat-connect that is less verbose

[ $# -eq 1 ] || { echo "Usage: $0 <channel-name>"; exit 1; }

channel="$1"
irc_dir="$HOME/scr/irc"

[ -d "$irc_dir" ] || { echo "Error: IRC directory $irc_dir not found"; exit 1; }

# Find server with the channel using POSIX approach
server=""
for server_dir in "$irc_dir"/irc.*; do
    [ -d "$server_dir" ] || continue
    [ -d "$server_dir/#$channel" ] || continue
    server="${server_dir##*/}"
    break
done

[ -n "$server" ] || { echo "Error: Channel #$channel not found"; exit 1; }

exec lchat-connect "$irc_dir" "$server" "#$channel"
